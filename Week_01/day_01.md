### 1. 进程虚拟地址空间布局  
**Text段**
  - 包含程序的可执行代码及只读常量
  - 映射为只读且可共享（多个进程运行同一份代码时共用物理内存）

**Data段**
  - 存放**已初始化**的全局变量和静态变量
  - 编译链接时已知大小，存储在可执行文件中  

**BSS段**
  - 存放**未初始化**的全局/静态变量 
  - 编译时仅保留大小信息，运行时分配并清零，在可执行文件中不占实际空间

**Heap**  
  - 通过 `malloc`/`new` 动态分配，向高地址增长 
  - 扩展或收缩通过 `brk`/`sbrk` 或 `mmap` 实现 

**文件映射区** 
  - 包含动态链接库（共享库）、`mmap` 映射的内存（如内存映射文件、匿名映射等）

**Stack**
  - 存储函数调用的局部变量、返回地址、参数等，向低地址扩展  

**内核空间**  
  - 用户态不可直接访问（受操作系统保护） 

---

### 2. C++内存模型  
**栈区**
  - 存储局部变量、函数参数、返回地址及调用过程中的临时信息  
  - 函数调用时分配，返回后自动释放
  - **生命周期**：函数/作用域结束时销毁

**堆区 / 自由存储区** 
  - **堆**：通过 `malloc`/`free` 或系统调用（`brk`/`mmap`）管理
  - **自由存储区**：通过 `new`/`delete` 管理 
  - **生命周期**：程序员手动控制

**常量存储区** 
  - 存储字符串字面量、`const` 修饰的只读数据（可能位于 `.rodata` 或代码段）  
  - 标记为只读，程序运行期间始终存在

**全局/静态存储区**  
  - 存放已初始化的全局/静态变量（Data段）和未初始化的全局/静态变量（BSS段）
  - 包括类的静态成员、函数内的静态局部变量
  - **生命周期**：程序启动时分配，结束时回收

**代码区**  
  - 存储可执行指令（机器码）和只读常量 
  - 标记为只读，多进程共享同一代码段
---

### 3. 存储持续性、作用域和链接性  
**存储持续性**  
  - **静态**：全局变量、静态变量（程序执行期间存在） 
  - **线程**：`thread_local`（线程生命周期）
  - **自动**：局部变量（函数/块结束时销毁）
  - **动态**：`new`/`malloc` 分配（堆/自由存储区）  

**作用域**  
  - **块作用域**：`{}` 内的变量（如 `if`/`for` 块）
  - **函数作用域**：局部变量
  - **命名空间作用域**：命名空间内的标识符 
  - **类作用域**：类成员变量/函数
  - **文件作用域**：全局变量（未在函数/类内声明） 

**链接性**  
  - **无链接**：局部变量（仅当前作用域可见）
  - **内部链接**：`static` 全局变量或 `const` 变量（当前翻译单元内可见）
  - **外部链接**：普通全局变量或 `extern` 声明（跨翻译单元可见）

---

### 4. malloc和free  
**基本功能**  
  - `malloc`：在堆上分配指定大小的内存块，返回指针
  - `free`：释放 `malloc` 分配的内存块

**内存分配策略**  
  - **<128KB**：通过 `brk`/`sbrk` 扩展堆空间 
  - **>128KB**：通过 `mmap` 映射新虚拟地址空间 

**底层机制** 
  - **`brk`/`sbrk`**：调整堆的末端地址（`program break`）
  - **`mmap`**：映射文件或匿名内存到虚拟地址空间
  - **元数据**：分配的内存块前部存储大小等信息

**物理地址映射** 
  - 通过页表和MMU实现虚拟地址到物理内存的映射
  - 首次访问时触发缺页中断分配物理页
